<h1 style="margin-bottom:30px">Questionnaires List</h1>
<div class="container">
    <div class="row">
        <div  class="col-sm-6">
            <div *ngIf="isAdmin"  class="btn-group btn-group-sm" role="group" aria-label="Questionnaire List Toolbar" >
                <button type="button" class="btn btn-default glyphicon glyphicon-plus"
                    aria-label="Add" (click)="createQuestionnaire()"></button>
                <button type="button" class="btn btn-default glyphicon glyphicon-pencil" 
                    aria-label="Edit" (click)="editSelected()" [disabled]="!isEditEnabled"></button>
                <button type="button" class="btn btn-default glyphicon glyphicon-trash" 
                    aria-label="Delete" (click)="modalDelete.open()" [disabled]="!isDeleteEnabled"></button>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="Search">
                <div class="input-group-btn">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button">
                            <span class="glyphicon glyphicon-search" style="height: 20px"></span>
                        </button>
                    </span>
                </div>
            </div>
        </div>
    </div>
    <div class="row">&nbsp;</div>
    <div class="row" style="margin-top:20px">
        <div class="col-sm-12">
            <table class="table">
                <tr>
                    <th>
                Description
            </th>
            <th>
                Date created
            </th>
            </tr>
                <tr *ngFor="let questionnaire of questionnaires">
                    <td>
                        <!--<button class="btn btn-xs btn-default" (click)="selected=questionnaire;modalDelete.open()">DEL</button>
                        <button class="btn btn-xs btn-default" (click)="gotoEdit(questionnaire)">EDIT</button>-->
                        <!--<button class="btn btn-xs btn-default" (click)="gotoView(questionnaire)">VIEW</button>-->
                        <input *ngIf="isAdmin" type="checkbox" [(ngModel)]="questionnaire.Selected" (change)="onSelectionChange(questionnaire)" />
                        <span><a (click)="gotoView(questionnaire)">{{questionnaire.Description}}</a></span>
                    </td>
                    <td>
                        {{questionnaire.CreateDate | date:'dd/MM/y'}}
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12 ">
            <nav aria-label="Page navigation" class="text-center">
                <ul class="pagination">
                    <li>
                        <a href="#" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    <li *ngFor="let page of pages"><a href="{{page.Link}}">{{page.Text}}</a></li>
                    <li>
                        <a href="#" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>


<h3>Debug stuff</h3>
<input type="checkbox" [(ngModel)]="isAdmin" />Admin mode
<ul>
    <li>IsEditEnabled: {{isEditEnabled}}</li>
    <li>IsDeleteEnabled: {{isDeleteEnabled}}</li>
    <li *ngFor="let q of selected">Selected: {{q.Description}}</li>
</ul>

<br>
Create example Questionnaires
<code>
DECLARE @cnt INT = 0;

WHILE @cnt < 100
BEGIN
   insert into Questionnaire (Description,CreateDate,Date) values
   ('Example questionnaire n. '+CAST(@cnt AS VARCHAR(16)), GETDATE(), GETDATE())
   SET @cnt = @cnt + 1;
END;
</code>


<modal #modalDelete (onClose)="confirmDelete()">
    <modal-header [show-close]="true">
        <h4 class="modal-title">Deleting:</h4>
    </modal-header>
    <modal-body>
        Are you sure you want to delete selected questionnaires?<br/> 
        <p *ngFor="let q of selected">
            ({{q.Id}}) {{q.Description}}
        </p>
    </modal-body>
    <modal-footer>
        <button type="button" class="btn btn-default" autofocus data-dismiss="modal" (click)="modalDelete.dismiss()">Cancel</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="modalDelete.close()">Yes</button>
    </modal-footer>
</modal>